<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sendspin Sample Player</title>
    <link rel="stylesheet" href="public/styles.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Sendspin Sample Player</h1>
        <p class="subtitle">
          A sample web player using the
          <a href="https://github.com/sendspin/sendspin-js" target="_blank"
            >sendspin-js</a
          >
          SDK
        </p>
      </header>

      <main>
        <!-- Connection Section -->
        <section class="card">
          <h2>Server Connection</h2>
          <div class="form-group">
            <label for="server-url">Server URL</label>
            <input
              type="text"
              id="server-url"
              placeholder="http://homeassistant.local:8927"
              spellcheck="false"
            />
            <small>Enter the Sendspin server WebSocket endpoint</small>
          </div>
          <div class="button-group">
            <button id="connect-btn" class="btn btn-primary">Connect</button>
            <button id="copy-url-btn" class="btn btn-secondary">
              Copy Share URL
            </button>
          </div>
        </section>

        <!-- Playback Controls -->
        <section class="card" id="controls-section">
          <h2>Playback Controls</h2>
          <div class="volume-control">
            <label for="volume-slider">Volume</label>
            <div class="volume-row">
              <button id="mute-btn" class="btn btn-icon" title="Toggle Mute">
                <span id="mute-icon">ðŸ”Š</span>
              </button>
              <input
                type="range"
                id="volume-slider"
                min="0"
                max="100"
                value="80"
              />
              <span id="volume-value">80%</span>
            </div>
          </div>
          <div class="form-group">
            <label for="sync-delay">Sync Delay (ms)</label>
            <div class="sync-delay-row">
              <input
                type="number"
                id="sync-delay"
                value="0"
                min="-1000"
                max="1000"
                step="10"
              />
              <button id="apply-sync-delay" class="btn btn-secondary">
                Apply
              </button>
            </div>
            <small
              >Adjust audio sync delay to compensate for device latency</small
            >
          </div>
        </section>

        <!-- Status Section -->
        <section class="card">
          <h2>Player Status</h2>
          <div class="status-grid">
            <div class="status-item">
              <span class="status-label">Connection</span>
              <span id="connection-status" class="status-value disconnected"
                >Disconnected</span
              >
            </div>
            <div class="status-item">
              <span class="status-label">Playback</span>
              <span id="playback-status" class="status-value">Stopped</span>
            </div>
            <div class="status-item">
              <span class="status-label">Sync State</span>
              <span id="sync-status" class="status-value">-</span>
            </div>
            <div class="status-item">
              <span class="status-label">Format</span>
              <span id="format-status" class="status-value">-</span>
            </div>
          </div>

          <h3>Sync Information</h3>
          <div class="status-grid">
            <div class="status-item">
              <span class="status-label">Clock Drift</span>
              <span id="clock-drift" class="status-value">-</span>
            </div>
            <div class="status-item">
              <span class="status-label">Sync Error</span>
              <span id="sync-error" class="status-value">-</span>
            </div>
            <div class="status-item">
              <span class="status-label">Output Latency</span>
              <span id="output-latency" class="status-value">-</span>
            </div>
            <div class="status-item">
              <span class="status-label">Resync Count</span>
              <span id="resync-count" class="status-value">-</span>
            </div>
          </div>
        </section>

        <!-- Code Example -->
        <section class="card">
          <h2>Code Example</h2>
          <p>
            This player is built with vanilla JavaScript using the sendspin-js
            SDK:
          </p>
          <pre><code>import { SendspinPlayer } from '@music-assistant/sendspin-js';

const player = new SendspinPlayer({
  playerId: 'my-player-id',
  baseUrl: 'http://your-server:8095',
  clientName: 'My Web Player',
  audioOutputMode: 'direct',
  onStateChange: (state) => {
    console.log('State changed:', state);
  }
});

// Connect to server
await player.connect();

// Control playback
player.setVolume(80);
player.setMuted(false);

// Disconnect when done
player.disconnect();</code></pre>
        </section>
      </main>

      <footer>
        <p>
          <a
            href="https://github.com/music-assistant/sendspin-js"
            target="_blank"
            >GitHub</a
          >
          |
          <a
            href="https://www.npmjs.com/package/@music-assistant/sendspin-js"
            target="_blank"
            >npm</a
          >
          | Part of the
          <a href="https://github.com/Sendspin/spec" target="_blank"
            >Sendspin Protocol</a
          >
        </p>
      </footer>
    </div>

    <!-- Hidden audio element for media-element mode (mobile support) -->
    <audio id="audio-element" style="display: none"></audio>

    <script type="module" src="public/app.js"></script>
  </body>
</html>
